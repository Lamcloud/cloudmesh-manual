

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cloudmesh Multi Cloud Storage Interface &mdash; Cloudmesh v4 alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Infrastructure Workflow" href="../workflow.html" />
    <link rel="prev" title="Flavors" href="../vm/flavor.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Cloudmesh v4
          

          
          </a>

          
            
            
              <div class="version">
                4.0.28
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">PREFACE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preface/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preface/contributors.html">Contributors</a></li>
</ul>
<p class="caption"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/mongo.html">Cloudmesh Database</a></li>
</ul>
<p class="caption"><span class="caption-text">MANUAL PAGES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cmd5.html">Cmd5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference-card.html">Reference Card</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual-cmd5.html">Manual Cmd5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual-group.html">Manual Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual-compute.html">Compute Manual Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual-storage.html">Storage Manual Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual-other.html">Manual Other</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/index.html">Jupyter Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Cloudmesh Command API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html#cloudmesh-api">Cloudmesh API</a></li>
</ul>
<p class="caption"><span class="caption-text">CONTRIBUTION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects/index.html">Cloudmesh Development Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/conventions.html">Code Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/manual.html">Documentation Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/manual.html#version-management">Version Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/management.html">Code Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/pytest.html">Pytest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/todo.html">ToDo</a></li>
</ul>
<p class="caption"><span class="caption-text">CLOUD ACCOUNTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../accounts/aws.html">AWS Account Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/azure.html">Azure Account Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/google.html">Google Storage Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/box.html">Box Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/accountcreation-old.html">VM Providers (outdated)</a></li>
</ul>
<p class="caption"><span class="caption-text">OTHER</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tbd.html">OTHER</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../configuration/encryption.html">Cloudmesh Yaml file Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../group.html">Group command</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vm/vm.html">Virtual Machine Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vm/image.html">Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vm/flavor.html">Flavors</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cloudmesh Multi Cloud Storage Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-storage-command">General Storage Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#awss3-cloudmesh-integration">AWSS3 Cloudmesh Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cloudmesh-aws-object-storage-interfaces">Cloudmesh AWS Object Storage Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-object-directory">Create Object Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#put">Put</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get">Get</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete">Delete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#storage-functions-overview">Storage functions overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-dir">Create dir</a></li>
<li class="toctree-l4"><a class="reference internal" href="#put-1">Put</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-1">Get</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search">Search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-1">List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-1">Delete</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pytests">Pytests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generic-tests">Generic Tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="#provider-specific-pytests">Provider Specific Pytests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#general-features">General features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#command-line-interface">Command Line Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-interface">Programming Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytests-1">Pytests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#virtual-directory">Virtual Directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytests-2">Pytests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#google-drive">Google drive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#note">Note</a></li>
<li class="toctree-l4"><a class="reference internal" href="#links">Links</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../workflow.html">Infrastructure Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/batch.html">Batch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/refcard.html">HPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openapi/README-storage-openapi.html">Cloudmesh Multi Cloud Open API Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openapi/ufo.html">REST Service (outdated)</a></li>
<li class="toctree-l2"><a class="reference internal" href="database.html">Cloudmesh Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/README.html">Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/awsec2-vm-management-benchmark.html">AWS EC2 VM Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/awsec2_benchmark_ubuntu.html">AWS EC2 VM Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/awss3-storage-benchmark.html">AWS S3 File Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/azure-storage-benchmark.html">Azure Blob Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/box.html">Benchmark results for box Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/emr.html">AWS EMR Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/test_compute_database.html">AWS EC2 Compute Database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tbd.html#outdated">OUTDATED</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cloudmesh v4</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tbd.html">OTHER</a> &raquo;</li>
        
      <li>Cloudmesh Multi Cloud Storage Interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/storage/storage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cloudmesh-multi-cloud-storage-interface">
<h1>Cloudmesh Multi Cloud Storage Interface<a class="headerlink" href="#cloudmesh-multi-cloud-storage-interface" title="Permalink to this headline">¶</a></h1>
<p>Cloudmesh supports multiple cloud storage services. You can access them
via commandline, an API or REST services. A simple abstraction layer
between cloud services and you local computer makes it possible that the
services are accessed the same way. This includes AwsS3, Azure, Google,
and box.</p>
<p>The code is available a cloudmesh module at</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/cloudmesh/cloudmesh-storage">https://github.com/cloudmesh/cloudmesh-storage</a></p></li>
</ul>
<p><a class="reference external" href="https://pypi.python.org/pypi/cloudmesh-storage"><img alt="Version" src="https://img.shields.io/pypi/v/cloudmesh-storage.svg" /></a> <a class="reference external" href="https://github.com/cloudmesh/cloudmesh-storage/blob/master/LICENSE"><img alt="License" src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" /></a> <a class="reference external" href="https://pypi.python.org/pypi/cloudmesh-storage"><img alt="Python" src="https://img.shields.io/pypi/pyversions/cloudmesh-storage.svg" /></a> <a class="reference external" href="https://pypi.python.org/pypi/cloudmesh-storage"><img alt="Format" src="https://img.shields.io/pypi/format/cloudmesh-storage.svg" /></a> <a class="reference external" href="https://pypi.python.org/pypi/cloudmesh-storage"><img alt="Status" src="https://img.shields.io/pypi/status/cloudmesh-storage.svg" /></a> <a class="reference external" href="https://travis-ci.com/cloudmesh/cloudmesh-storage"><img alt="Travis" src="https://travis-ci.com/cloudmesh/cloudmesh-storage.svg?branch=master" /></a></p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>the pip install is not yet enabled. Please use the source install
instead (see Installation instructions).</p>
</div>
<p>The storage module can be installed with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install cloudmesh-storage
</pre></div>
</div>
<p>or if you install it from source with the cloudmesh installer</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir cm
<span class="nb">cd</span> cm
cloudmesh-installer git clone storage
cloudmesh-installer install storage -e
</pre></div>
</div>
</div>
<div class="section" id="general-storage-command">
<h2>General Storage Command<a class="headerlink" href="#general-storage-command" title="Permalink to this headline">¶</a></h2>
<p>To view the manual page for the  storage command, type in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms <span class="nb">help</span> storage
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>include the storage command here</p>
</div>
<p>Tos set a storage provider so you do not have to specify it with <code class="docutils literal notranslate"><span class="pre">--storage</span></code></p>
<p>we can set it with the set command. We have the following providers to chose
from:</p>
<p><code class="docutils literal notranslate"><span class="pre">box</span></code>, <code class="docutils literal notranslate"><span class="pre">awss3</span></code> , <code class="docutils literal notranslate"><span class="pre">awsstorage</span></code>, <code class="docutils literal notranslate"><span class="pre">azure</span></code>, <code class="docutils literal notranslate"><span class="pre">google</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms <span class="nb">set</span> <span class="nv">storage</span><span class="o">=</span>awss3
</pre></div>
</div>
<p>To list the storage service you can say</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage list
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="awss3-cloudmesh-integration">
<h2>AWSS3 Cloudmesh Integration<a class="headerlink" href="#awss3-cloudmesh-integration" title="Permalink to this headline">¶</a></h2>
<p>AWS S3 file storage has been integrated with cloudmesh library and is
available for use via commandline. As a first step we need to modify
<code class="docutils literal notranslate"><span class="pre">cloudmesh4.yaml</span></code> config file. Under ‘storage’ section, we need to add
the aws section to specify the parameters used to store files in AWS S3.</p>
<p>In the credentials section under aws, specify the access key id and
secret access key which will be available in the AWS console under
<code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">service</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Users</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Security</span> <span class="pre">Credentials</span></code>.</p>
<p>Container is the default bucket which will be used to store the files in
AWS S3. Region is the geographic area like <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> which contains
the bucket. Region is required to get a connection handle on the S3
Client or resource for that geographic area.</p>
<p>Here is a sample.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cloudmesh:
  ...
  storage:
    aws:
      cm:
        heading: aws
        host: amazon.aws.com
        label: aws
        kind: awsS3
        version: TBD
      default:
        directory: TBD
      credentials:
        access_key_id: *********
        secret_access_key: *******
        container: name of bucket that you want user to be contained in.
        region: us-east-1
</pre></div>
</div>
</div>
<div class="section" id="cloudmesh-aws-object-storage-interfaces">
<h2>Cloudmesh AWS Object Storage Interfaces<a class="headerlink" href="#cloudmesh-aws-object-storage-interfaces" title="Permalink to this headline">¶</a></h2>
<p>Object Storage is one of the feature in AWS S3 and this feature
integrated with cloudmesh library and is available for use via
commandline.</p>
<p>Follow the below steps:</p>
<ul class="simple">
<li><p>Modify <code class="docutils literal notranslate"><span class="pre">cloudmesh4.yaml</span></code> config file in ‘cloudmesh-storage’
section. User need to add required object storage parameters to
communicate with cloud(AWS S3)</p></li>
<li><p>In the credentials section under <code class="docutils literal notranslate"><span class="pre">awsobjectstore</span></code>, add the
parameter values of access_key_id and secret_access_key, these
credentials will be gained from appropriate cloud vendor(For ex:
AWS), in the case of AWS, these will be available which will be
available in the AWS console under <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">service</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Users</span></code>
-&gt; <code class="docutils literal notranslate"><span class="pre">Security</span> <span class="pre">Credentials</span></code>.</p></li>
</ul>
<p>Here is a sample.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cloudmesh:
  ...
  storage:
    objstore:
      cm:
        heading: AWS
        host: aws.com
        label: AWS
        kind: awsobjectstore
        version: <span class="m">1</span>.0
      default:
        directory: AWS
      credentials:
        region: <span class="s2">&quot;&quot;</span>
        access_key_id: <span class="s2">&quot;&quot;</span>
        secret_access_key: <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="create-object-directory">
<h2>Create Object Directory<a class="headerlink" href="#create-object-directory" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage create /base_path/targetdir
</pre></div>
</div>
</div>
<div class="section" id="put">
<h2>Put<a class="headerlink" href="#put" title="Permalink to this headline">¶</a></h2>
<p>The put command uploads object from your local system to AWS S3 object
storage</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage put ~/.cloudmesh/objstore/sourcedir /base_path/targetdir --recursive
</pre></div>
</div>
</div>
<div class="section" id="get">
<h2>Get<a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h2>
<p>The put command retrieve or download a object from AWS S3 object storage</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage get /bucket_name/src ~/.cloudmesh/objstore/dest --recursive
</pre></div>
</div>
</div>
<div class="section" id="list">
<h2>List<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h2>
<p>The list command lists all the contents of a cloud object details. If
the recursive option is specified, it will list the contents of all the
nested objects information</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage list /bucket_name/dest --recursive
</pre></div>
</div>
</div>
<div class="section" id="delete">
<h2>Delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h2>
<p>The delete command can delete objects on cloud storage. Once object
deletes it will never be rollback and delete applicable to nested
objects when function <code class="docutils literal notranslate"><span class="pre">--recursive</span></code> used. Deleting a folder will
delete its contents as well (including the sub-directories).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage delete /bucket_name/est --recursive
</pre></div>
</div>
<div class="section" id="storage-functions-overview">
<h3>Storage functions overview<a class="headerlink" href="#storage-functions-overview" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="create-dir">
<h3>Create dir<a class="headerlink" href="#create-dir" title="Permalink to this headline">¶</a></h3>
<p>This command helps to create a new directory on AWS S3. You must specify
the full path of the new directory you would like to create.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage --storage<span class="o">=</span><span class="s1">&#39;aws&#39;</span> create dir /base_path/targetdir
</pre></div>
</div>
</div>
<div class="section" id="put-1">
<span id="id3"></span><h3>Put<a class="headerlink" href="#put-1" title="Permalink to this headline">¶</a></h3>
<p>The put command uploads files from your local host to the S3.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage put ~/.cloudmesh/storage/sourcedir /base_path/targetdir --recursive
</pre></div>
</div>
<p>Source for this command could be either a file or directory.</p>
<p>If you specify a file as the source, the file will be uploaded if no
such file exists on the cloud or updated if a copy already exists on the
cloud.</p>
<p>If the source is a directory, you can choose to specify the recursive
option to upload the files in the sub-directories in the source as well
to the target directory in S3. If the recursive option is not specified,
only the files in the source directory will be uploaded to the target
directory and the sub-directories will be ignored.</p>
</div>
<div class="section" id="get-1">
<span id="id4"></span><h3>Get<a class="headerlink" href="#get-1" title="Permalink to this headline">¶</a></h3>
<p>The get command downloads files from S3 to your local host.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage get /base_container/sourcedir ~/.cloudmesh/storage/targetdir --recursive
</pre></div>
</div>
<p>Source for this command could be either a file or directory.</p>
<p>If you specify a file as the source, you need to specify the full path
of file including the file name where you want the file to be
downloaded. In case you do not specify the file name and only give the
target directory, then the file will be downloaded with the same name as
present on S3.</p>
<p>If the source is a directory, you can choose to specify the recursive
option to download files in the sub-directories in the source as well to
the target directory in your local host. If the recursive option is not
specified, only the files in the source directory will be downloaded to
the target directory and the sub-directories will be ignored.</p>
</div>
<div class="section" id="search">
<h3>Search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h3>
<p>The search command helps to search for a particular file within a
directory.</p>
<p>If recursive options is specified, Cloudmesh will search for the file in
all sub-directories of the original directory as well.</p>
<p>To search for a file at the root, pass an empty string or / as the
target dir.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage search /base_path/targetdir testfile.txt --recursive
</pre></div>
</div>
<p>Note that for the Box storage provider, objects are only indexed every 5
to 10 minutes and will not show up in a search until they have been
indexed.</p>
</div>
<div class="section" id="list-1">
<span id="id5"></span><h3>List<a class="headerlink" href="#list-1" title="Permalink to this headline">¶</a></h3>
<p>The list command lists all the contents of a cloud directory. If the
recursive option is specified, it will list the contents of all
sub-directories as well.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage list /base_path/targetdir --recursive
</pre></div>
</div>
</div>
<div class="section" id="delete-1">
<span id="id6"></span><h3>Delete<a class="headerlink" href="#delete-1" title="Permalink to this headline">¶</a></h3>
<p>The delete command can delete files or folders from your cloud file
storage. Deleting a folder will delete its contents as well (including
the sub-directories).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms storage delete /base_path/targetdir --recursive
</pre></div>
</div>
</div>
</div>
<div class="section" id="pytests">
<h2>Pytests<a class="headerlink" href="#pytests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generic-tests">
<h3>Generic Tests<a class="headerlink" href="#generic-tests" title="Permalink to this headline">¶</a></h3>
<p>We have developed a number of simple pytests that can be called. To see
the list of Pytests go to our directory</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/cloudmesh/cloudmesh-storage/tree/master/tests">https://github.com/cloudmesh/cloudmesh-storage/tree/master/tests</a></p></li>
</ul>
<p>We also developed a general pytest that works across providers and can
be invoked as follows</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms <span class="nb">set</span> <span class="nv">storage</span><span class="o">=</span>box
pytest -v --capture<span class="o">=</span>no tests/test_storage.py

cms <span class="nb">set</span> <span class="nv">storage</span><span class="o">=</span>azure
pytest -v --capture<span class="o">=</span>no tests/test_storage.py

cms <span class="nb">set</span> <span class="nv">storage</span><span class="o">=</span>gdrive
pytest -v --capture<span class="o">=</span>no tests/test_storage.py

cms <span class="nb">set</span> <span class="nv">storage</span><span class="o">=</span>awss3
pytest -v --capture<span class="o">=</span>no tests/test_storage.py
</pre></div>
</div>
</div>
<div class="section" id="provider-specific-pytests">
<h3>Provider Specific Pytests<a class="headerlink" href="#provider-specific-pytests" title="Permalink to this headline">¶</a></h3>
<p>Open a terminal and navigate to the cloudmesh-storage directory. Enter
the following command to run pytests:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest -v --capture<span class="o">=</span>no tests/test_storage_box.py
pytest -v --capture<span class="o">=</span>no tests/test_azure.py
pytest -v --capture<span class="o">=</span>no tests/test_storage_aws.py
</pre></div>
</div>
<p>TODO: rename to</p>
<ul class="simple">
<li><p>test_storage_azure.py</p></li>
</ul>
</div>
</div>
<div class="section" id="general-features">
<h2>General features<a class="headerlink" href="#general-features" title="Permalink to this headline">¶</a></h2>
<p>How to set up the authentication to a specific service is discussed in
later sections</p>
<p>TODO: Provide a simple programming example with the general provider</p>
<div class="section" id="command-line-interface">
<h3>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h3>
<p>TBD</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cms <span class="nb">set</span> <span class="nv">storage</span><span class="o">=</span>azure
cms storage list
</pre></div>
</div>
</div>
<div class="section" id="programming-interface">
<h3>Programming Interface<a class="headerlink" href="#programming-interface" title="Permalink to this headline">¶</a></h3>
<p>TBD</p>
<p>Cloudmesh Storage provides a simple programming API interface that you
can use. We highlight a simple example for storing and retrieving a
file form a storage provider.</p>
<p>We assume the files at the given path exist</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cloudmesh.storage.provider.Provider</span> <span class="kn">as</span> <span class="nn">Provider</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.util</span> <span class="kn">import</span> <span class="n">path_expand</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">Provider</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s2">&quot;azure&quot;</span><span class="p">)</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">path_expand</span><span class="p">(</span><span class="s2">&quot;~/.cloudmesh/storage/test/a/a.txt&quot;</span><span class="p">)</span>
<span class="n">dst</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
<span class="c1"># The result will be a dict of the information which you can print with</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="pytests-1">
<span id="id7"></span><h3>Pytests<a class="headerlink" href="#pytests-1" title="Permalink to this headline">¶</a></h3>
<p>Script to test the GDrive service can be accessed under tests folder
using the following pytest command.</p>
<p>TODO rename to test_storage_gdrive.py</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest -v --capture<span class="o">=</span>no tests/test_gdrive.py
</pre></div>
</div>
</div>
</div>
<div class="section" id="virtual-directory">
<h2>Virtual Directory<a class="headerlink" href="#virtual-directory" title="Permalink to this headline">¶</a></h2>
<p>The virtual directory has been developed to mirror the linux directory
commands. File links in the virtual directory point to files on storage
providers, which can be retrieved using the virtual directory.</p>
<div class="section" id="id8">
<h3>Configuration<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>The credentials for the virtual directory are the same as for the admin
mongo command. See the Mongo section for details.</p>
</div>
<div class="section" id="pytests-2">
<span id="id9"></span><h3>Pytests<a class="headerlink" href="#pytests-2" title="Permalink to this headline">¶</a></h3>
<p>The vdir command can be tested as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest -v --capture<span class="o">=</span>no tests/test_vdir.py
</pre></div>
</div>
</div>
</div>
<div class="section" id="google-drive">
<h2>Google drive<a class="headerlink" href="#google-drive" title="Permalink to this headline">¶</a></h2>
<p>The Google Drive API needs the following two 2 credentials files. *
<code class="docutils literal notranslate"><span class="pre">client_secret.json</span></code> * <code class="docutils literal notranslate"><span class="pre">google-drive-credentials.json</span></code></p>
<p>If we run the Google Drive <code class="docutils literal notranslate"><span class="pre">Provider.py</span></code> for the <strong>First time</strong> then
the required keys, tokens are taken from the <code class="docutils literal notranslate"><span class="pre">cloudmesh4.yaml</span></code> file
and creates a <code class="docutils literal notranslate"><span class="pre">client_secret.json</span></code> file in the following path
<code class="docutils literal notranslate"><span class="pre">~/.cloudmesh/gdrive/</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">Authentication.py</span></code> creates a <code class="docutils literal notranslate"><span class="pre">.credentials</span></code> folder under the
following path <code class="docutils literal notranslate"><span class="pre">~/.cloudmesh/gdrive/</span></code> if it does not exist and creates
a <code class="docutils literal notranslate"><span class="pre">google-drive-credentials.json</span></code> file under the following folder
<code class="docutils literal notranslate"><span class="pre">~/.cloudmesh/gdrive/.credentials/</span></code></p>
<p>So, for the <strong>First time</strong> browser will be opened up automatically and
asks for the Google Drive(gmail) credentials i.e., login email and
password. If you provide these 2 then the Authentication step is
completed and then it will create the <code class="docutils literal notranslate"><span class="pre">google-drive-credentials.json</span></code>
and place it in <code class="docutils literal notranslate"><span class="pre">~/.cloudmesh/gdrive/.credentials/</span></code> folder.</p>
<p>These steps are to be followed for the first time or initial run. Once
it is done then our program is set. After these steps then the program
will run automatically by using these credentials stored in the
respective files.</p>
<div class="section" id="note">
<h3>Note<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h3>
<p>The Google Drive API accepts these 2 files in the form of <strong>.json file
format</strong> and not in the form of a dictionary.</p>
</div>
<div class="section" id="links">
<h3>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h3>
<p>Link for additional information:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/cloudmesh-community/sp19-516-130/blob/master/gdrive.md">https://github.com/cloudmesh-community/sp19-516-130/blob/master/gdrive.md</a></p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../workflow.html" class="btn btn-neutral float-right" title="Infrastructure Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../vm/flavor.html" class="btn btn-neutral float-left" title="Flavors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Cloudmesh Community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>