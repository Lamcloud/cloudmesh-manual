

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cloudmesh.multipass.Provider &mdash; Cloudmesh v4 alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Cloudmesh v4
          

          
          </a>

          
            
            
              <div class="version">
                4.0.28
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">PREFACE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../preface/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../preface/contributors.html">Contributors</a></li>
</ul>
<p class="caption"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/mongo.html">Cloudmesh Database</a></li>
</ul>
<p class="caption"><span class="caption-text">CONCEPTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/compute.html">Multicloud Compute Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/storage.html">Multicloud Storage Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/database.html">Multicloud Database Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/providers.html">Cloudmesh Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/openapi.html">OpenAPI Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/namespaces.html">Package Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/commandshell.html">Extensible Command Shell</a></li>
</ul>
<p class="caption"><span class="caption-text">MANUAL PAGES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cmd5.html">Cmd5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference-card.html">Reference Card</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual-configuration.html">Manual Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual-cmd5.html">Manual Cmd5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual-group.html">Manual Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual-compute.html">Compute Manual Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual-storage.html">Storage Manual Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual-other.html">Manual Other</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../jupyter/index.html">Jupyter Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">Cloudmesh Command API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html#cloudmesh-api">Cloudmesh API</a></li>
</ul>
<p class="caption"><span class="caption-text">CONTRIBUTION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/index.html">Cloudmesh Development Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/manual.html">Documentation Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/manual.html#version-management">Version Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/management.html">Code Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/pytest.html">Pytest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/todo.html">ToDo</a></li>
</ul>
<p class="caption"><span class="caption-text">OTHER</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tbd.html">OTHER</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tbd.html#outdated">OUTDATED</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Cloudmesh v4</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>cloudmesh.multipass.Provider</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cloudmesh.multipass.Provider</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">cloudmesh.abstract.ComputeNodeABC</span> <span class="kn">import</span> <span class="n">ComputeNodeABC</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.DateTime</span> <span class="kn">import</span> <span class="n">DateTime</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.Printer</span> <span class="kn">import</span> <span class="n">Printer</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.Shell</span> <span class="kn">import</span> <span class="n">Shell</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.console</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.util</span> <span class="kn">import</span> <span class="n">banner</span>
<span class="kn">from</span> <span class="nn">cloudmesh.common.dotdict</span> <span class="kn">import</span> <span class="n">dotdict</span>

<span class="c1"># some of the banners will be removed.</span>
<span class="c1"># they must be used for dryrun</span>
<span class="c1"># we also keep it for shell, abd create</span>

<span class="c1"># in case of create we need to look at cloudmesh-openstack as it also measures </span>
<span class="c1"># the time it takes to start the image and includes it into the cm dict</span>

<span class="c1"># all but the shell need to return a cm dict even if the original multipass does</span>
<span class="c1"># not return one for example if we delete a vom we need to return the cmdict</span>
<span class="c1"># with a stuatus and introduce a status &quot;DELETE&quot;</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">from the launch documentation to derive sample. This will be used to create the</span>
<span class="sd">manual page for cms multipass. The sample in the provider will be used for the</span>
<span class="sd">cms register command which is defined in cloudmesh-cloud so you can add</span>
<span class="sd">multipass to your yaml fie.</span>


<span class="sd">Options:</span>
<span class="sd">  -h, --help           Display this help</span>
<span class="sd">  -v, --verbose        Increase logging verbosity, repeat up to three times for</span>
<span class="sd">                       more detail</span>
<span class="sd">  -c, --cpus &lt;cpus&gt;    Number of CPUs to allocate.</span>
<span class="sd">                       Minimum: 1, default: 1.</span>
<span class="sd">  -d, --disk &lt;disk&gt;    Disk space to allocate. Positive integers, in bytes, or</span>
<span class="sd">                       with K, M, G suffix.</span>
<span class="sd">                       Minimum: 512M, default: 5G.</span>
<span class="sd">  -m, --mem &lt;mem&gt;      Amount of memory to allocate. Positive integers, in</span>
<span class="sd">                       bytes, or with K, M, G suffix.</span>
<span class="sd">                       Minimum: 128M, default: 1G.</span>
<span class="sd">  -n, --name &lt;name&gt;    Name for the instance. If it is &#39;primary&#39; (the</span>
<span class="sd">                       configured primary instance name), the user&#39;s home</span>
<span class="sd">                       directory is mounted inside the newly launched instance,</span>
<span class="sd">                       in &#39;Home&#39;.</span>
<span class="sd">  --cloud-init &lt;file&gt;  Path to a user-data cloud-init configuration, or &#39;-&#39; for</span>
<span class="sd">                       stdin</span>

<span class="sd">Arguments:</span>
<span class="sd">  image                Optional image to launch. If omitted, then the default</span>
<span class="sd">                       Ubuntu LTS will be used.</span>
<span class="sd">                       &lt;remote&gt; can be either ‘release’ or ‘daily‘. If &lt;remote&gt;</span>
<span class="sd">                       is omitted, ‘release’ will be used.</span>
<span class="sd">                       &lt;image&gt; can be a partial image hash or an Ubuntu release</span>
<span class="sd">                       version, codename or alias.</span>
<span class="sd">                       &lt;url&gt; is a custom image URL that is in http://, https://,</span>
<span class="sd">                       or file:// format.</span>
<span class="sd">                       </span>
<span class="sd">Gregor: interesting is the file:// and http(s):// we shoudl try if we can </span>
<span class="sd">  do 19.10 on </span>
<span class="sd">  osx and windows</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># multipass mount</span>
<span class="c1"># multipass transfer</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  delete    Delete instances</span>
<span class="sd">  exec      Run a command on an instance</span>
<span class="sd">  find      Display available images to create instances from</span>
<span class="sd">  get       Get a configuration setting</span>
<span class="sd">  help      Display help about a command</span>
<span class="sd">  info      Display information about instances</span>
<span class="sd">  launch    Create and start an Ubuntu instance</span>
<span class="sd">  list      List all available instances</span>
<span class="sd">  mount     Mount a local directory in the instance</span>
<span class="sd">  purge     Purge all deleted instances permanently</span>
<span class="sd">  recover   Recover deleted instances</span>
<span class="sd">  restart   Restart instances</span>
<span class="sd">  set       Set a configuration setting</span>
<span class="sd">  shell     Open a shell on a running instance</span>
<span class="sd">  start     Start instances</span>
<span class="sd">  stop      Stop running instances</span>
<span class="sd">  suspend   Suspend running instances</span>
<span class="sd">  transfer  Transfer files between the host and instances</span>
<span class="sd">  umount    Unmount a directory from an instance</span>
<span class="sd">  version   Show version details</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="Provider"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider">[docs]</a><span class="k">class</span> <span class="nc">Provider</span><span class="p">(</span><span class="n">ComputeNodeABC</span><span class="p">):</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;multipass&quot;</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    cloudmesh:</span>
<span class="s2">      cloud:</span>
<span class="s2">        </span><span class="si">{name}</span><span class="s2">:</span>
<span class="s2">          cm:</span>
<span class="s2">            active: true</span>
<span class="s2">            heading: </span><span class="si">{name}</span><span class="s2"></span>
<span class="s2">            host: TBD</span>
<span class="s2">            label: </span><span class="si">{name}</span><span class="s2"></span>
<span class="s2">            kind: multipass</span>
<span class="s2">            version: TBD</span>
<span class="s2">            service: compute</span>
<span class="s2">          credentials:</span>
<span class="s2">            username: TBD</span>
<span class="s2">            key_path: ~/.ssh/id_rsa.pub</span>
<span class="s2">          default:</span>
<span class="s2">            size: m1.medium</span>
<span class="s2">            image: 18.04</span>
<span class="s2">            cpu: 1</span>
<span class="s2">            disk: 5G</span>
<span class="s2">            mem: 1GB</span>
<span class="s2">            @ cloudinit: file:// ... or http:// </span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;vm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;sort_keys&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cm.name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cm.name&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;cm.cloud&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;ipv4&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;name&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;release&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;state&quot;</span><span class="p">],</span>
            <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Cloud&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Address&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Release&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;State&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;sort_keys&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cm.name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cm.name&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;os&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;release&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;remote&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;version&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;aliases&quot;</span><span class="p">],</span>
            <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;OS&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Release&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Version&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Alias&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;sort_keys&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cm.name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;state&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;images_release&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;memory&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;mounts&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;ipv4&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;release&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;image_hash&quot;</span><span class="p">],</span>
            <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;State&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Image Release&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Memory&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Mounts&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Ipv4&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Release&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;Image Hash&quot;</span><span class="p">]</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="c1"># please add a status here if there is one that you observe. WHat are all</span>
    <span class="c1"># the States form multipass?</span>

    <span class="n">STATUS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;UNKOWN&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;multipass&quot;</span><span class="p">,</span>
                 <span class="n">configuration</span><span class="o">=</span><span class="s2">&quot;~/.cloudmesh/cloudmesh.yaml&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the multipass provider. The default parameters are read</span>
<span class="sd">        from the configuration file that is defined in yaml format.</span>

<span class="sd">        :param name: The name of the provider as defined in the yaml file</span>
<span class="sd">        :param configuration: The location of the yaml configuration file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#</span>
        <span class="c1"># The following will be added later once we have identified how to</span>
        <span class="c1"># configure multipass from cloudmesh.yaml. This requires understanding</span>
        <span class="c1"># the get and set methods and setting defaults for sizes</span>
        <span class="c1">#</span>
        <span class="c1"># conf = Config(configuration)[&quot;cloudmesh&quot;]</span>
        <span class="c1"># super().__init__(name, conf)</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloudtype</span> <span class="o">=</span> <span class="s2">&quot;multipass&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud</span> <span class="o">=</span> <span class="n">name</span>

    <span class="c1"># noinspection PyPep8Naming</span>
    <span class="c1"># TODO: docstring</span>
<div class="viewcode-block" id="Provider.Print"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.Print">[docs]</a>    <span class="k">def</span> <span class="nf">Print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;secrule&quot;</span><span class="p">:</span>
                <span class="c1"># this is just a temporary fix, both in sec.py and</span>
                <span class="c1"># here the secgruops and secrules should be separated</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="c1"># for rule in group[&#39;security_group_rules&#39;]:</span>
                    <span class="c1">#     rule[&#39;name&#39;] = group[&#39;name&#39;]</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">result</span>

            <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>  <span class="c1"># not pretty</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;header&#39;</span><span class="p">]</span>  <span class="c1"># not pretty</span>
            <span class="c1"># humanize = self.output[kind][&#39;humanize&#39;]  # not pretty</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">Printer</span><span class="o">.</span><span class="n">flatwrite</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                                    <span class="n">sort_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                                    <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                                    <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
                                    <span class="c1"># humanize=humanize</span>
                                    <span class="p">)</span>
                  <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Printer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">))</span></div>

<div class="viewcode-block" id="Provider.remove_spinner"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.remove_spinner">[docs]</a>    <span class="k">def</span> <span class="nf">remove_spinner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">str</span>
        <span class="n">line</span><span class="o">.</span><span class="n">repalace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">08-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">repalace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">08|&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">repalace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">08</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">repalace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">08/&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">line</span></div>

<div class="viewcode-block" id="Provider.update_dict"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.update_dict">[docs]</a>    <span class="k">def</span> <span class="nf">update_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        converts the dict into a list</span>

<span class="sd">        :param elements: the list of original dicts. If elements is a single</span>
<span class="sd">                         dict a list with a single element is returned.</span>
<span class="sd">        :param kind: for some kinds special attributes are added. This includes</span>
<span class="sd">                     key, vm, image, flavor.</span>
<span class="sd">        :return: The list with the modified dicts</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">elements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

            <span class="k">if</span> <span class="s2">&quot;cm&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;cm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># if kind == &#39;ip&#39;:</span>
            <span class="c1">#    entry[&#39;name&#39;] = entry[&#39;floating_ip_address&#39;]</span>

            <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;cm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="n">kind</span><span class="p">,</span>
                <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloudtype</span><span class="p">,</span>
                <span class="s2">&quot;cloud&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">key</span>
            <span class="p">})</span>

            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;vm&#39;</span><span class="p">:</span>

                <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;cm&quot;</span><span class="p">][</span><span class="s2">&quot;updated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>

                <span class="c1"># if &#39;public_v4&#39; in entry:</span>
                <span class="c1">#    entry[&#39;ip_public&#39;] = entry[&#39;public_v4&#39;]</span>

                <span class="c1"># if &quot;created_at&quot; in entry:</span>
                <span class="c1">#    entry[&quot;cm&quot;][&quot;created&quot;] = str(entry[&quot;created_at&quot;])</span>
                <span class="c1"># del entry[&quot;created_at&quot;]</span>
                <span class="c1">#    if &#39;status&#39; in entry:</span>
                <span class="c1">#        entry[&quot;cm&quot;][&quot;status&quot;] = str(entry[&quot;status&quot;])</span>
                <span class="c1"># else:</span>
                <span class="c1">#    entry[&quot;cm&quot;][&quot;created&quot;] = entry[&quot;modified&quot;]</span>

            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;image&#39;</span><span class="p">:</span>

                <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;cm&quot;</span><span class="p">][</span><span class="s2">&quot;created&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;updated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                    <span class="n">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>

            <span class="c1"># elif kind == &#39;version&#39;:</span>

            <span class="c1">#    entry[&quot;cm&quot;][&quot;created&quot;] = str(DateTime.now())</span>

            <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>

        <span class="c1"># IMPLEMENT, new method</span>

<div class="viewcode-block" id="Provider.version"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.version">[docs]</a>    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns just the version</span>

<span class="sd">        :return: version dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span>
            <span class="s2">&quot;multipass&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;multipassd&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass version&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;multipass  &quot;</span><span class="p">,</span> <span class="s2">&quot;multipass &quot;</span><span class="p">)</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">d</span></div>

    <span class="c1"># New method to return vm status</span>
    <span class="c1"># TODO: docstring</span>
    <span class="k">def</span> <span class="nf">_get_vm_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>

        <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass info </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> --format=json&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;instance &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; does not exist&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s2">&quot;instance does not exist&quot;</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">]</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">dict_result</span>

    <span class="k">def</span> <span class="nf">_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        internal method that returns a native multipass dict of the images.</span>

<span class="sd">        :return: dict of images in multipass format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;multipass find --format=json&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># TODO: relpace with json.loads</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;images&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">dict_result</span>

<div class="viewcode-block" id="Provider.images"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.images">[docs]</a>    <span class="k">def</span> <span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the images on the cloud</span>

<span class="sd">        :return: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Provider.image"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.image">[docs]</a>    <span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the image with a given name</span>

<span class="sd">        :param name: The name of the image</span>
<span class="sd">        :return: the dict of the image</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_images</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">name</span><span class="p">]]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        internal method that returns the dict of all vms</span>

<span class="sd">        :return: dict of vms in multipass format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;multipass list --format=json&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># TODO: relpace with json.loads</span>
        <span class="c1">#</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">dict_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;vms&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">dict_results</span>
<div class="viewcode-block" id="Provider.vm"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.vm">[docs]</a>    <span class="k">def</span> <span class="nf">vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the vms on the cloud</span>

<span class="sd">        :return: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vm</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;vm&quot;</span><span class="p">)</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.start"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        start a node</span>

<span class="sd">        :param name: the unique node name</span>
<span class="sd">        :return:  The dict representing the node</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass start </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                           <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Error when starting instance&quot;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get the vm status.</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.delete"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the names instance</span>

<span class="sd">        :param name: The name</span>
<span class="sd">        :param purge: if set to tru also purges the instance</span>
<span class="sd">        :return: the dict of the deleted vm</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;delete </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">purge</span><span class="p">:</span>
            <span class="c1"># terminate and purge</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass delete </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> --purge&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Error when deleting/destroying instance&quot;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                               <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Instance destroyed (deleted and purged)&quot;</span><span class="p">}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># terminate only</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass delete </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Error when deleting/destroying instance&quot;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Instance deleted&quot;</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.list"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        list all vm Instances</span>

<span class="sd">        :return: an array of dicts representing the nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Already implemented by vm method</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vm</span><span class="p">()</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.shell"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.shell">[docs]</a>    <span class="k">def</span> <span class="nf">shell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        log into the shell of instance</span>

<span class="sd">        :return: an empty string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">banner</span><span class="p">(</span><span class="s2">&quot;shell&quot;</span><span class="p">)</span>

        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass shell </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

    <span class="c1"># IMPLEMENT, POSSIBLE BUG wilth live</span>
<div class="viewcode-block" id="Provider.run"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">executor</span><span class="o">=</span><span class="s2">&quot;buffer&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        executes a command in a named multipass instance</span>

<span class="sd">        :param name: the name of the instance</span>
<span class="sd">        :param command: the command</span>
<span class="sd">        :param executor: one of live, buffer, os</span>
<span class="sd">        :return: only returned when using live or buffer</span>

<span class="sd">        live   = prints the output immediatly but also buffers it and returns</span>
<span class="sd">                 it at the end</span>

<span class="sd">        buffer = buffers the result and only returns it after the command has</span>
<span class="sd">                 executed.</span>

<span class="sd">        os =     just uses os.system and returns a &quot;&quot; at the end. This is good</span>
<span class="sd">                 for debugging</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;run </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># improve next line</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">executor</span> <span class="o">==</span> <span class="s2">&quot;buffer&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass exec </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_spinner</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">executor</span> <span class="o">==</span> <span class="s2">&quot;buffer&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass exec </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_spinner</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">executor</span> <span class="o">==</span> <span class="s2">&quot;os&quot;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass exec </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;run: executor must be cloudmesh or os, found: </span><span class="si">{executor}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># IMPLEMENT, new method</span>
<div class="viewcode-block" id="Provider.get"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns the variable with the given key name from multipass</span>

<span class="sd">        :param key: the key name</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass get </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># IMPLEMENT, new method</span>
<div class="viewcode-block" id="Provider.set"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the multipass variable with the kename to value</span>

<span class="sd">        :param key: the name of the key</span>
<span class="sd">        :param value: the value to be set</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass set </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.stop"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        stops the node with the given name</span>

<span class="sd">        :param name of the instance to stop</span>
<span class="sd">        :return: The dict representing the node including updated status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stop </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass stop </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                           <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Error when stopping instance&quot;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get the vm status.</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># IMPLEMENT</span>
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets the information of a node with a given name</span>

<span class="sd">        :param name:</span>
<span class="sd">        :return: The dict representing the node including updated status</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">name</span><span class="p">]]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.suspend"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.suspend">[docs]</a>    <span class="k">def</span> <span class="nf">suspend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        suspends the node with the given name</span>

<span class="sd">        :param name: the name of the node</span>
<span class="sd">        :return: The dict representing the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;suspend </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass suspend </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Get the vm status.</span>
        <span class="n">dict_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.resume"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.resume">[docs]</a>    <span class="k">def</span> <span class="nf">resume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        resume the named node</span>

<span class="sd">        :param name: the name of the node</span>
<span class="sd">        :return: the dict of the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;resume </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass start </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Get the vm status.</span>
        <span class="n">dict_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># IMPLEMENT</span>
<div class="viewcode-block" id="Provider.destroy"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.destroy">[docs]</a>    <span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Destroys the node</span>
<span class="sd">        :param name: the name of the node</span>
<span class="sd">        :return: the dict of the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;destroy </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

    <span class="c1"># IMPLEMENT</span>
    <span class="c1"># TODO: se the sample for defaults they are not idenitified</span>
    <span class="c1">#  from kwargs and passed along</span>
<div class="viewcode-block" id="Provider.create"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">timeout</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span>
               <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        creates a named node</span>

<span class="sd">        :param group: a list of groups the vm belongs to</span>
<span class="sd">        :param name: the name of the node</span>
<span class="sd">        :param image: the image used</span>
<span class="sd">        :param size: the size of the image</span>
<span class="sd">        :param timeout: a timeout in seconds that is invoked in case the image</span>
<span class="sd">                        does not boot.</span>
<span class="sd">               The default is set to 3 minutes.</span>
<span class="sd">        :param kwargs: additional arguments passed along at time of boot</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create one node</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;create </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> using image </span><span class="si">{</span><span class="n">image</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="n">dotdict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">memory</span>
        <span class="n">cpu</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">cpus</span>
        <span class="n">disk</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">disk</span>
        <span class="n">cloud_init</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">cloud_init</span>

        <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;multipass launch --name </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Add options to create command</span>
        <span class="k">if</span> <span class="n">cpu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; --cpus </span><span class="si">{</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; --mem </span><span class="si">{</span><span class="n">memory</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; --disk </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">cloud_init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">command</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; --cloud-init </span><span class="si">{</span><span class="n">cloud_init</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">image</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># result = Shell.live(command, )  # ?</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="c1"># Get the vm status.</span>
        <span class="n">dict_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.set_server_metadata"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.set_server_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">set_server_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the metadata for the server</span>

<span class="sd">        :param name: name of the fm</span>
<span class="sd">        :param metadata: the metadata</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.get_server_metadata"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.get_server_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_server_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets the metadata for the server</span>

<span class="sd">        :param name: name of the fm</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.delete_server_metadata"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.delete_server_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">delete_server_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets the metadata for the server</span>

<span class="sd">        :param name: name of the fm</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># IMPLEMENT</span>
    <span class="c1"># TODO: pytest</span>
<div class="viewcode-block" id="Provider.rename"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.rename">[docs]</a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rename a node</span>

<span class="sd">        :param destination:</span>
<span class="sd">        :param name: the current name</span>
<span class="sd">        :return: the dict with the new name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass info </span><span class="si">{</span><span class="n">old_name</span><span class="si">}</span><span class="s2"> --format=json&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
        <span class="n">dict_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">result</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="n">new_name</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">dict_results</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.keys"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the keys on the cloud</span>

<span class="sd">        :return: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.key_upload"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.key_upload">[docs]</a>    <span class="k">def</span> <span class="nf">key_upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        uploads the key specified in the yaml configuration to the cloud</span>
<span class="sd">        :param key:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.key_delete"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.key_delete">[docs]</a>    <span class="k">def</span> <span class="nf">key_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        deletes the key with the given name</span>
<span class="sd">        :param name: The name of the key</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.flavors"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.flavors">[docs]</a>    <span class="k">def</span> <span class="nf">flavors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the flavors on the cloud</span>

<span class="sd">        :return: dict of flavors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.flavor"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.flavor">[docs]</a>    <span class="k">def</span> <span class="nf">flavor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the flavor with a given name</span>
<span class="sd">        :param name: The name of the flavor</span>
<span class="sd">        :return: The dict of the flavor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># IMPLEMENT, POSSIBLE BUG wilth live</span>
<div class="viewcode-block" id="Provider.reboot"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.reboot">[docs]</a>    <span class="k">def</span> <span class="nf">reboot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reboot a list of nodes with the given names</span>

<span class="sd">        :param name: name of instance to reboot</span>
<span class="sd">        :return:  A list of dict representing the nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">banner</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;reboot </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Shell.live(f&quot;multipass restart {name}&quot;)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multipass restart </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">dict_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dict_result</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.attach_public_ip"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.attach_public_ip">[docs]</a>    <span class="k">def</span> <span class="nf">attach_public_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        adds a public ip to the named vm</span>

<span class="sd">        :param name: Name of the vm</span>
<span class="sd">        :param ip: The ip address</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.detach_public_ip"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.detach_public_ip">[docs]</a>    <span class="k">def</span> <span class="nf">detach_public_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        adds a public ip to the named vm</span>

<span class="sd">        :param name: Name of the vm</span>
<span class="sd">        :param ip: The ip address</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.delete_public_ip"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.delete_public_ip">[docs]</a>    <span class="k">def</span> <span class="nf">delete_public_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the ip address</span>

<span class="sd">        :param ip: the ip address, if None than all will be deleted</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.list_public_ips"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.list_public_ips">[docs]</a>    <span class="k">def</span> <span class="nf">list_public_ips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">available</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the public ip addresses.</span>

<span class="sd">        :param available: if True only those that are not allocated will be</span>
<span class="sd">            returned.</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.create_public_ip"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.create_public_ip">[docs]</a>    <span class="k">def</span> <span class="nf">create_public_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new public IP address to use</span>

<span class="sd">        :return: The ip address information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.find_available_public_ip"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.find_available_public_ip">[docs]</a>    <span class="k">def</span> <span class="nf">find_available_public_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a single public available ip address.</span>

<span class="sd">        :return: The ip</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.get_public_ip"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.get_public_ip">[docs]</a>    <span class="k">def</span> <span class="nf">get_public_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns the public ip</span>

<span class="sd">        :param name: name of the server</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.list_secgroups"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.list_secgroups">[docs]</a>    <span class="k">def</span> <span class="nf">list_secgroups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List the named security group</span>

<span class="sd">        :param name: The name of the group, if None all will be returned</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.list_secgroup_rules"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.list_secgroup_rules">[docs]</a>    <span class="k">def</span> <span class="nf">list_secgroup_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List the named security group</span>

<span class="sd">        :param name: The name of the group, if None all will be returned</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.upload_secgroup"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.upload_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">upload_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.add_secgroup"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.add_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">add_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.add_secgroup_rule"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.add_secgroup_rule">[docs]</a>    <span class="k">def</span> <span class="nf">add_secgroup_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># group name</span>
                          <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">protocol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">ip_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.remove_secgroup"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.remove_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">remove_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.add_rules_to_secgroup"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.add_rules_to_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">add_rules_to_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rules</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.remove_rules_from_secgroup"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.remove_rules_from_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">remove_rules_from_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rules</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># IMPLEMENT, work with Gregor</span>
    <span class="c1"># see cloudmesh-openstack already implemented there</span>
<div class="viewcode-block" id="Provider.wait"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.wait">[docs]</a>    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">vm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        wais till the given VM can be logged into</span>

<span class="sd">        :param vm: name of the vm</span>
<span class="sd">        :param interval: interval for checking</span>
<span class="sd">        :param timeout: timeout</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># repeatedly tries run aof a knwpn command such as uname -a and</span>
        <span class="c1"># sees if it returns without error.</span>
        <span class="c1"># if it reaches timeout it fails</span>
        <span class="c1"># We may want to create a special static class for this as this is</span>
        <span class="c1"># the same likely for all clouds.</span>
        <span class="c1"># maybe just place in the ABC class or so as implemenattion so we</span>
        <span class="c1"># inherit</span>
        <span class="c1"># samee with ssh</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.console"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.console">[docs]</a>    <span class="k">def</span> <span class="nf">console</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets the output from the console</span>

<span class="sd">        :param vm: name of the VM</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

    <span class="c1"># DO NOT IMPLEMENT</span>
<div class="viewcode-block" id="Provider.log"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.log">[docs]</a>    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="Provider.info"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the info on the cloud</span>

<span class="sd">        :return: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        an internal method that returns the info of all instances as a dict in</span>
<span class="sd">        multipass</span>

<span class="sd">        :return: dict of all instances in multipass</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;multipass info --all --format=json&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># TODO: relpace with json.loads</span>
        <span class="c1">#</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">result</span><span class="p">)[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1"># implement</span>
<div class="viewcode-block" id="Provider.mount"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.mount">[docs]</a>    <span class="k">def</span> <span class="nf">mount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        mounts the sourse into the instance at the given destination</span>

<span class="sd">        TODO: proper docstring</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;multipass mount --name=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">destination</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;make sure to specify all attributes&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># TODO: this should return the newly mounted volume as cloudmesh json</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># implement</span>
<div class="viewcode-block" id="Provider.umount"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.umount">[docs]</a>    <span class="k">def</span> <span class="nf">umount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unmount a directory from an instance.</span>

<span class="sd">        TODO: propper docstring</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="c1"># implement</span>
<div class="viewcode-block" id="Provider.transfer"><a class="viewcode-back" href="../../../api/cloudmesh.multipass.html#cloudmesh.multipass.Provider.Provider.transfer">[docs]</a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">,</span>
                 <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copies files or entire directories into the instance</span>

<span class="sd">        TODO: proper docstring</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># you may need to use glob for dirs (recursively)</span>
        <span class="c1"># just create a glob and put it in a list.</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;multipass transfer --name=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">destination</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;make sure to specify all attributes&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># TODO: this should return the newly mounted volume as cloudmesh json</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># excellent-titmouse is multipass instance name</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Provider</span><span class="p">()</span>  <span class="c1"># name=&quot;cloudmesh&quot;</span>
    <span class="c1">#p.vm()</span>
    <span class="c1">#p.start(&quot;testvm&quot;)</span>
    <span class="c1">#p.stop(&quot;testvm&quot;)</span>
    <span class="c1">#p.vm()</span>
    <span class="c1">#p.run(&quot;uname -r&quot;)</span>
    <span class="c1">#p.images()</span>
    <span class="c1">#p.delete(&quot;testvm&quot;)</span>
    <span class="c1">#p.vm()</span>
    <span class="c1">#p.list()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Cloudmesh Community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>